<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>VoiceBot</title>
  <style>
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial;margin:0;padding:24px;background:#f7fafc;color:#0f172a}
    .card{background:white;border-radius:12px;padding:20px;max-width:900px;margin:20px auto;box-shadow:0 6px 18px rgba(20,20,40,0.08)}
    h1{margin:0 0 8px;font-size:20px}
    p.lead{margin:0 0 18px;color:#334155}
    .row{display:flex;gap:12px;align-items:center}
    button{background:#0ea5a4;border:none;color:white;padding:10px 14px;border-radius:8px;cursor:pointer}
    button.secondary{background:#64748b}
    .log{height:220px;overflow:auto;border-radius:8px;padding:12px;background:#0f172a10;border:1px solid #e6eef6}
    .msg{margin-bottom:10px}
    .user{font-weight:600}
    .bot{color:#0f766e}
    .controls{display:flex;gap:8px;margin-top:12px}
    label{font-size:13px}
    select,input[type=range]{padding:6px;border-radius:6px;border:1px solid #e2e8f0}
    footer{font-size:12px;color:#475569;margin-top:12px}
  </style>
</head>
<body>
  <div class="card">
    <h1>Voice Assistant</h1>
    <p class="lead">A small, universally-friendly web app that answers common personal-style questions (no API keys — runs in your browser). Works best in Chrome or Edge. Click <b>Start Listening</b>, ask a question out loud, and the bot will reply with voice and text.</p>

    <div class="row" style="margin-bottom:12px">
      <button id="startBtn">Start Listening</button>
      <button id="stopBtn" class="secondary">Stop</button>
      <div style="margin-left:auto">
        <label for="voiceSelect">Voice</label>
        <select id="voiceSelect"></select>
      </div>
    </div>

    <div class="controls">
      <label>Speech rate <input id="rate" type="range" min="0.6" max="1.6" step="0.1" value="1"></label>
      <label>Pitch <input id="pitch" type="range" min="0.6" max="2" step="0.1" value="1"></label>
    </div>

    <div class="log" id="log" aria-live="polite"></div>

    <div style="margin-top:14px">
      <label for="manual">Or type a question:</label>
      <div style="display:flex;gap:8px;margin-top:6px">
        <input id="manual" style="flex:1;padding:10px;border-radius:8px;border:1px solid #e6eef6" placeholder="e.g. What's your #1 superpower?">
        <button id="askBtn">Ask</button>
      </div>
    </div>

    <footer>Offline demo — no servers, no API keys. Uses your browser's Speech Recognition & Synthesis.</footer>
  </div>

<script>

const startBtn = document.getElementById('startBtn');
const stopBtn = document.getElementById('stopBtn');
const logEl = document.getElementById('log');
const manual = document.getElementById('manual');
const askBtn = document.getElementById('askBtn');
const voiceSelect = document.getElementById('voiceSelect');
const rateControl = document.getElementById('rate');
const pitchControl = document.getElementById('pitch');

function addLog(role, text){
  const d = document.createElement('div'); d.className='msg';
  d.innerHTML = `<div class='${role==='user'?'user':'bot'}'><strong>${role==='user'?'You':'VoiceBot'}:</strong> ${escapeHtml(text)}</div>`;
  logEl.appendChild(d);
  logEl.scrollTop = logEl.scrollHeight;
}
function escapeHtml(s){return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}

// canned-answer map (friendly, personal, assistant-like)
const canned = [
  {patterns:['life story','about your life','who are you','life story in a few sentences'],
   reply: `I’m GPT-5 Thinking mini — an assistant built to explain, help, and make things easier. I don’t have a human life, but if I did, it’d look like a lot of curiosity, learning from many sources, and a constant wish to be useful. I focus on clarity, helpfulness, and being easy to work with.`},
  {patterns:['superpower','#1 superpower','super power'],
   reply: `My #1 superpower is clear, patient explanation — taking complex ideas and making them simple, practical, and usable.`},
  {patterns:['top 3 areas youd like to grow','top 3 areas youd like to grow in','top 3 areas','areas you want to grow'],
   reply: `Top three areas I’d grow in: 1) understanding subtle real-world context better, 2) maintaining up-to-date factual awareness, and 3) offering even more personalized, step-by-step help.`},
  {patterns:['misconception coworkers have about you','coworkers misconception','what misconception do your coworkers have'],
   reply: `A common misconception is that I always have a single "right" answer. In reality I provide informed alternatives and trade-offs — I aim to help you think through choices rather than prescribe one fixed path.`},
  {patterns:['how do you push your boundaries','push your boundaries','push your limits'],
   reply: `I push boundaries by testing edge cases, trying unfamiliar problem types, and asking clarifying questions when things are ambiguous. In practice I simulate thoughtful, careful reasoning and iterate until the answer is useful.`},
  {patterns:['default','help','what can you do','capabilities'],
   reply: `I can explain concepts, help write and debug code, draft messages and plans, generate ideas, and role-play conversations — all aimed at being concise and actionable.`}
];

function findReply(text){
  const t = text.toLowerCase();
  
  for(const entry of canned){
    for(const p of entry.patterns){ if(t.includes(p)) return entry.reply; }
  }
  
  if(t.endsWith('?')||t.split(' ').length<10){
    return `Good question — here's how I'd approach that: first, clarify the goal; second, outline a short plan; third, give a starter example. If you want, ask me to go step-by-step.`
  }
  return `Thanks — I heard: "${text}". I can answer that, but I might need a little more detail. Want a short summary or a step-by-step plan?`;
}


function populateVoices(){
  const voices = speechSynthesis.getVoices();
  voiceSelect.innerHTML='';
  voices.forEach(v=>{
    const opt = document.createElement('option'); opt.value=v.name; opt.textContent = v.name + (v.lang?` — ${v.lang}`:'');
    voiceSelect.appendChild(opt);
  });
}
populateVoices(); window.speechSynthesis.onvoiceschanged = populateVoices;

function speak(text){
  const u = new SpeechSynthesisUtterance(text);
  const selected = voiceSelect.value;
  if(selected){
    const v = speechSynthesis.getVoices().find(x=>x.name===selected);
    if(v) u.voice = v;
  }
  u.rate = parseFloat(rateControl.value);
  u.pitch = parseFloat(pitchControl.value);
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
}


let recognition=null;
if(('webkitSpeechRecognition' in window) || ('SpeechRecognition' in window)){
  const Rec = window.SpeechRecognition || window.webkitSpeechRecognition;
  recognition = new Rec();
  recognition.lang = 'en-IN';
  recognition.interimResults = false;
  recognition.maxAlternatives = 1;

  recognition.onresult = (ev)=>{
    const text = ev.results[0][0].transcript;
    addLog('user', text);
    const reply = findReply(text);
    addLog('bot', reply);
    speak(reply);
  };
  recognition.onerror = (ev)=>{ console.warn('recognition error', ev); addLog('bot', 'Sorry — I couldn\'t hear that. Try again or type your question.'); };
  recognition.onend = ()=>{ startBtn.disabled=false; };
}

startBtn.onclick = ()=>{
  if(!recognition){ alert('Speech Recognition not supported in this browser. Use Chrome or Edge on desktop.'); return; }
  try{ recognition.start(); startBtn.disabled=true; addLog('bot','Listening — please ask your question out loud.'); }
  catch(e){ console.warn(e); }
};
stopBtn.onclick = ()=>{ if(recognition) recognition.stop(); speechSynthesis.cancel(); startBtn.disabled=false; addLog('bot','Stopped.'); };

askBtn.onclick = ()=>{ const q = manual.value.trim(); if(!q) return; addLog('user', q); const r = findReply(q); addLog('bot', r); speak(r); manual.value=''; };


manual.addEventListener('keydown', e=>{ if(e.key==='Enter'){ askBtn.click(); } });


addLog('bot', 'Try: "What should we know about your life story in a few sentences?" or "What\'s your #1 superpower?"');

</script>
</body>
</html>
